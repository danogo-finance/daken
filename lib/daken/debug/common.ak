use aiken/cbor
use aiken/collection/list
use aiken/collection/pairs
use aiken/crypto.{DataHash, ScriptHash, VerificationKeyHash}
use aiken/interval
use cardano/address.{Address, Credential}
use cardano/assets.{AssetName, Lovelace, PolicyId, Value}
use cardano/certificate.{Certificate}
use cardano/governance.{
  GovernanceActionId, ProposalProcedure, TransactionId, Vote, Voter,
}
use cardano/transaction.{
  Datum, InlineDatum, Input, Output, OutputReference, Redeemer, ScriptPurpose,
  Transaction, ValidityRange,
}
use daken/cbor as daken_cbor

pub type FxTransaction {
  inputs: List<FxInput>,
  reference_inputs: List<FxInput>,
  outputs: List<FxOutput>,
  fee: Lovelace,
  mint: FxValue,
  certificates: List<Certificate>,
  withdrawals: Pairs<Credential, Lovelace>,
  validity_range: ValidityRange,
  extra_signatories: List<VerificationKeyHash>,
  redeemers: Pairs<ScriptPurpose, ByteArray>,
  datums: Pairs<DataHash, Data>,
  id: TransactionId,
  votes: Pairs<Voter, Pairs<GovernanceActionId, Vote>>,
  proposal_procedures: List<ProposalProcedure>,
  current_treasury_amount: Option<Lovelace>,
  treasury_donation: Option<Lovelace>,
}

pub type FxInput {
  output_reference: OutputReference,
  output: FxOutput,
}

pub type FxOutput {
  address: Address,
  value: FxValue,
  datum: Datum,
  reference_script: Option<ScriptHash>,
}

pub type FxValue =
  Pairs<PolicyId, Pairs<AssetName, Int>>

pub fn fx_placeholder() -> FxTransaction {
  FxTransaction {
    inputs: [],
    reference_inputs: [],
    outputs: [],
    fee: 0,
    mint: [],
    certificates: [],
    withdrawals: [],
    validity_range: interval.everything,
    extra_signatories: [],
    redeemers: [],
    datums: [],
    id: #"",
    votes: [],
    proposal_procedures: [],
    current_treasury_amount: None,
    treasury_donation: None,
  }
}

pub fn to_datum(datum: Datum) -> Datum {
  when datum is {
    InlineDatum(dt) -> {
      expect dt: ByteArray = dt
      expect Some(dt) = daken_cbor.deserialise(dt)
      InlineDatum(dt)
    }
    _ -> datum
  }
}

pub fn to_redeemers(
  redeemers: Pairs<ScriptPurpose, ByteArray>,
) -> Pairs<ScriptPurpose, Redeemer> {
  pairs.foldl(
    redeemers,
    [],
    fn(script_purpose, data, res) {
      expect Some(data) = daken_cbor.deserialise(data)
      [Pair(script_purpose, data), ..res]
    },
  )
}

pub fn to_value(self: FxValue) -> Value {
  self
    |> assets.from_asset_list
}

pub fn to_output(
  FxOutput { address, value, datum, reference_script }: FxOutput,
) -> Output {
  Output {
    address,
    datum: to_datum(datum),
    reference_script,
    value: to_value(value),
  }
}

pub fn to_input(FxInput { output_reference, output }: FxInput) -> Input {
  Input { output_reference, output: to_output(output) }
}

pub fn to_tx(
  FxTransaction {
    inputs,
    reference_inputs,
    outputs,
    fee,
    mint,
    certificates,
    withdrawals,
    validity_range,
    extra_signatories,
    redeemers,
    datums: _,
    id,
    votes,
    proposal_procedures,
    current_treasury_amount,
    treasury_donation,
  }: FxTransaction,
) -> Transaction {
  Transaction {
    ..transaction.placeholder,
    mint: to_value(mint),
    fee: fee,
    extra_signatories: extra_signatories,
    redeemers: to_redeemers(redeemers),
    inputs: list.map(inputs, to_input),
    outputs: list.map(outputs, to_output),
    reference_inputs: list.map(reference_inputs, to_input),
    validity_range: validity_range,
    id: id,
    certificates: certificates,
    withdrawals: withdrawals,
    votes: votes,
    proposal_procedures: proposal_procedures,
    current_treasury_amount: current_treasury_amount,
    treasury_donation: treasury_donation,
  }
}

test succ_default_serialise() {
  let expect_dt = cbor.serialise(fx_placeholder())
  #"d8799f80808000a080a0d8799fd8799fd87980d87a80ffd8799fd87b80d87a80ffff80a0a040a080d87a80d87a80ff" == expect_dt
}

test succ_deserialise_with_cbor() {
  expect Some(fx_tx) =
    daken_cbor.deserialise(
      #"d8799f9fd8799fd8799f58200043bbfb69482a244a3c4f8a13ccdd695824f7d94dd383c14a4d84516d25473d00ffd8799fd8799fd8799f581cda0f113fc97ff0898c9b10d194c06c4eb588c5ae939c026f25cd7485ffd8799fd8799fd8799f581c4566506d723dadff77d5d2f15f60b2ddc806ee67449279900d83c8aeffffffffbf40bf401a03f1e4a8ffffd87b9f43d87980ffd87a80ffffd8799fd8799f58200e91ad4419a537c49aefa3ef8f41bc271a48788a52ddad4467033bc90487796a00ffd8799fd8799fd8799f581cda0f113fc97ff0898c9b10d194c06c4eb588c5ae939c026f25cd7485ffd8799fd8799fd8799f581c4566506d723dadff77d5d2f15f60b2ddc806ee67449279900d83c8aeffffffffbf40bf401a001af6bcff581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ebf4574414749581b000000174876e8004574434f50491a3b9aca0044744441491a3b9aca004574444a45441a3b9aca0044744552471b000000e8d4a5100044744941471a3b9aca004574495553441a3b9aca0044744d494e1a3b9aca0045745348454e1a3b9aca004574534e454b1903e84574555344431b000000174876e8004574555344541b000000174876e8004474574d541a3b9aca00ffffd87980d87a80ffffd8799fd8799f58203a59a3b36881d3d048697be9415a7b7e5414efd5e20f752062be5a9267f4a87d00ffd8799fd8799fd8799f581cda0f113fc97ff0898c9b10d194c06c4eb588c5ae939c026f25cd7485ffd8799fd8799fd8799f581c4566506d723dadff77d5d2f15f60b2ddc806ee67449279900d83c8aeffffffffbf40bf401a001af6bcff581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ebf4574414749581b000000174876e8004574434f50491a3b9aca0044744441491a3b9aca004574444a45441a3b9aca0044744552471b000000e8d4a5100044744941471a3b9aca004574495553441a3b9aca0044744d494e1a3b9aca0045745348454e1a3b9aca004574534e454b1903e84574555344431b000000174876e8004574555344541b000000174876e8004474574d541a3b9aca00ffffd87980d87a80ffffd8799fd8799f5820b3d45b0769adfb2d4d326e675cccd4e0874ba39be1011b236766219169ae687a02ffd8799fd8799fd87a9f581c84cf3290f9070aa2c81f8b1edabc0eef0a98767bd353c22c6d47f0ffffd87a80ffbf40bf401a002dc6c0ff581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ebf44744441491b000000047307b925ff581ce85c54a6173bf0fd3ff21949a8e28cdac345892c5c9065b51f933180bf4001ffffd87b9f4a9f9f0000000000ff0cffffd87a80ffffff9fd8799fd8799f582006dce08391634a76e648b7a4a64cc66e1c888e4cd52cabf58229c48217a45ff600ffd8799fd8799fd87a9f581c5ee7312c98c994a839bc733d7177d13892a8c681ea1f6d1e90fd5fd0ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a001811f4ff581cbc2d3b7cf1009c788b1daf2208a38026ab20d7f8209d896ad1a09c14bf5820b7b2163016617c2eecb01494a50b7ff2b3f3a1ada295e3bf54a2c929f4d8744b01ffffd87b9f5840d8799f581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2581c88c60ad22e7c8d97a195fd755013cd235031ffd65b87d083e4b0764bffffd87a80ffffd8799fd8799f582050951e1a9efbc049851f7ca4f3cced7a55b78e2a8b4d87d2639d574c7dc9dd1400ffd8799fd8799fd87a9f581cd2618bed00c01da8106688655ec2bfbd0793304db22345ab4d493405ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a02d10d38ffffd87b9f43d87980ffd87a80ffffd8799fd8799f58206caa9b424f15db588c4a679f8bb50b784630a3f965c6084717326639e228953110ffd8799fd8799fd87a9f581cb181ba29acfc0eb07af719c09b75936bae31e92e5881048bfb855120ffd87a80ffbf40bf401a002dc6c0ff581cfb9f3e3fa95f506d46c90e693f3e0958bacef63fda9ac6925fffbed3bf4001ffffd87b9f5f58409f9f011832ff1a01c9c3809f0a080101ff1a003d09001a002f4d60011a000dbba00180581c1c435d15327f651a8d1a3a6cb02e28df089342c988cdc23b5e12445840741a001e84809f9f1acfa6ece31b0004000000000000ff9f1b000000014dd930af1b0008000000000000ff9f1b0000009036eb36c11b0010000000000000ff9f58400d14ffff9f1a000186231a000186a0ff9f0103ff069f011904e2ff9f0101ff9f0101ff9f0101ff9f0101ff581c84cf3290f9070aa2c81f8b1edabc0eef0a987658407bd353c22c6d47f0ff581cd005d3d7075f5e10aa3ce9f401a9ffdc3d25a5ed3af748c93fb3a469581c6c21d17401e8acf515c2a9cd8e6f52f94e22d741217f4058402b283ca22fd8799f43d87980ff581cc9d4e58457e0365d336e0d05d60b11776a0e65be40b4e59f06cf9665d8799f43d87980ff80000000d87a80d87a80d8799f499f090affffd87a80ffffffd87a80ffffd8799fd8799f58206febe8f8b4bf09305fbf3a9d11bbcb32e6d96e8b385c52b081e80fc1f7bc040800ffd8799fd8799fd87a9f581c5ee7312c98c994a839bc733d7177d13892a8c681ea1f6d1e90fd5fd0ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a008e50f8ff581cbc2d3b7cf1009c788b1daf2208a38026ab20d7f8209d896ad1a09c14bf58207a54331f21d6fed281a1cf8824826ac67b59f7b40eb2e23d2e39d8c9ab9fb6c001ffffd87b9f5f5840d8799fbf9f4040ff9fbf9f581c50e015ec8204db83a4f57aa9ee40ce6ea157e3b7335a149fafe3f37040ffd87a80ff1a00895440ff9f581c007c4fc75b7662fc5840735177aa714da9d1b06af5644df199fef39e5fc14466425443ff9fa000ff9f581c15560c68a570e214ec928631fcb053a6b0ba66657ca848ac79af8e504566555840534454ff9fa000ff9f581c719a4062e793eef77e3eb8bbe4966dadd0968a231c34cfaffefbfa8f4566434f5049ff9fbf9f581c77ac80841854404dcc5b4926055840ff2a4eabf0c33b243817eabd45fda840ffd87a80ff1a3e3a2d00ff9f581c834a15101873b4e1ddfaa830df46792913995d8738dcde34eda2790545665553444d5840ff9fbf9f581c61110758ac5ce00127ad24db20322728ee0b57899363b3e46048de2740ffd87a80ff1ab2d05e00ff9f581c919d4c2c9455016289341b1a14dedf5840697687af31751170d56a31466e4474444149ff9fbf9f581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e040ffd87a80ff1a01c9c380ff58409f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e4574444a4544ff9fbf9f581c12cfdb2723c68617af00dd77b11907c176f9946ec058407137cfe1c05217581c7f0d1f5f1240dde7c4a36a8632ba37aa3668318022b35f080295d845ffd87a809f581c6f262e859569d245aab15265a902dccf33f790a558407227ea30edbbdef440ffd87a80ff1a01c9c380ff9f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e4474455247ff9fbf9f581c91f45840199ccd6be5a9a9c1be2c84f71e9415de0ad9748ce08797796a1140ffd87a80ff1b000000091494c600ff9f581c919d4c2c9455016289341b1a14dedf697687af584031751170d56a31466e4474494147ff9fbf9f581cc610592d48f1ad8cdb7e68cad2566e94e5286bf9d398fc5cf3cd05cd40ffd87a80ff1a00895440ff9f581c9158409d4c2c9455016289341b1a14dedf697687af31751170d56a31466e457449555344ff9fbf9f581c540d76209b446a348d986c38f27985acbafd8922254a3bb0c25840b0685c40ffd87980ff1a01f78a40ff9f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e44744d494eff9fbf9f581c12cfdb2723c686584017af00dd77b11907c176f9946ec07137cfe1c05217581cdbad78f9ad842fd2a2dd88b61d53ffcbc08a2a2dd590c00b15426964ffd87a809f581c186cd98a295858405651c89f05807a876cf26cdf47a7f86f70be3b9e4cc040ffd87980ff1a767e7900ff9f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a314658406e4574534e454bff9fbf9f581c12cfdb2723c68617af00dd77b11907c176f9946ec07137cfe1c05217581ca217829b969c60a20d651c28f97ed2484509470ae658405b07fe394359a1ffd87a809f581c387b9ceaa2425032e2499ebeb6f95819f17addc804b7dc047a1a220240ffd87a80ff1991c1ff9f581c919d4c2c94550162895840341b1a14dedf697687af31751170d56a31466e457455534443ff9fbf9f581c349124259ba9beec3e1a43673c6cc0298f87aa9da7be1df7568e2d0c40ffd87a805840ff1ab2d05e00ff9f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e457455534454ff9fbf9f581c12f858143f3f4418b171461949f258407893a96f80e1e39d573921b5bd8640ffd87a80ff1ab2d05e00ff9f581c9304b7cd15ea2a37e7e71001fe4f158b731d119b6548c16de9c5acba4566494e4459ff58409fa000ff9f581c9750b8f991a7f4f41dd5e03ea4a723ca2c4c71bd15363f8dfe04bcf14566444a4544ff9fbf9f581ce3b1cd76b6ee6a2828c76aaa2c4862404f58402adbad3777c77cd78d05a640ffd87a80ff1a01c9c380ff9f581c9de4aa80ab5b2223cc6f31652204c9451f9db7d3336db5681316f9f54466455448ff9fa000ff58409f581ca19f2152d46081fc51804dfda27cdd08264d2a1d833678f827da7db445665348454eff9fbf9f581cc7903dc4abe8adf33dc054b47b6fc02e99ea5a947f58402cf34df1d72b4b40ffd87a80ff1a04b571c0ff9f581ca28ea55fce00dbb39354f4988a40e828b1d60b7cdea4a72690eda587456655534443ff9fa000ff9f581c5840c339ca7dc121f2974c110508ea1750289e52c8a750935b097945334f58205d79967b8337970a967813643436623aab142f7629cc00f6bcda175f4924ff8dff9f5840a000ff9f581cc339ca7dc121f2974c110508ea1750289e52c8a750935b097945334f58206765bbd069a2b97c65867581fc3fa80ae748b86b806d97c244039efa58409c440607ff9fa000ff9f581cc339ca7dc121f2974c110508ea1750289e52c8a750935b097945334f5820bb5fdf9485d67503c3f2873b229858daee3a8b346eb05840e3d39a11370e2d680ffdff9fa000ffff1864d8799fd8799f581c1e12f4c64e2748ec5ad3038099d402c7c1ccb96a562a8d1e70dbcabfffd87a80ff18c8d8799f5840d8799f581c628d8852963f7f06534ebfb9970eb7829773f193017a76e027750b18ffd87a80ff581c171387cbbdd1110a118b03f846a8851e7e5360fdc7991eb745c2130da6ffffffd87a80ffffd8799fd8799f582076f8a71d3eb0c79838210adaab9a61668ac7ee9f8236939d9d56ba77dd50037a00ffd8799fd8799fd87a9f581ca4e62274b4765cdb63c66fac3fa223af78b4ffa480f2ac3bf61c17e6ffd87a80ffbf40bf401a00fda836ffffd87980d87a80ffffd8799fd8799f582090715cc6418b360efe6c903a1840d8bc2c95321093c0345383717ae68b74f84100ffd8799fd8799fd87a9f581ca4e62274b4765cdb63c66fac3fa223af78b4ffa480f2ac3bf61c17e6ffd87a80ffbf40bf401a00e13f16ffffd87980d87a80ffffd8799fd8799f5820a5e6b2c1439e84283f820ef00f3f3f6611c5fff1508cc31872aaf91f50648e8500ffd8799fd8799fd87a9f581cca732cafaeaee5afcd23ee56b96d02f083a0567b3f0864986eb530b6ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a00198458ff581cbd23e2977937bb6054f625e5b566e28e294dcd8f7e8d0d33979ed90cbf5820511b1d8a3e44ca092979a644a281ced038143231d2b810c660a982edca18415b01ffffd87b9f5f5840d8799f9f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e4474444149ffbf9f581c7d4913bb4e27f4708116769b1a77cd66e9110b205678c7f2c1d09bc0e040ff9f9f9f0cd87980ffffffffffffffd87a80ffffd8799fd8799f5820b3d45b0769adfb2d4d326e675cccd4e0874ba39be1011b236766219169ae687a01ffd8799fd8799fd87a9f581cb07dabd6daef3cfcccef4e91aa39e568a9e2cc0ce4a8c702099c9614ffd87a80ffbf40bf401a002dc6c0ff581c9975292b341ff70ac18fad3870de8791cb4d0ece11c04a74a9dc3699bf4001ffffd87b9f5f58409f1b000000047307b9190c1b0000020c2ffed28b1b0000000684d63a6f1a80667ad51b0046a82c964cec749f1ba9383475dbba60a1c24b022f49fca400000000582f0000ff1b00000196dd8d9e401b00000196ddabfbb09f1b0000000b5e9655cc1b0000020c2ffed28bff1a002dc6c0ffffffd87a80ffffd8799fd8799f5820c5275e1324af91426f5bc6acaa8382c3ba7d5097cf0bd21db807c8b249a94a2b00ffd8799fd8799fd87a9f581cd2618bed00c01da8106688655ec2bfbd0793304db22345ab4d493405ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a025bec6affffd87b9f43d87980ffd87a80ffffd8799fd8799f5820e348ff9df1d5628837d90f76711e74cc2afd4659d9a729d4ab02f2982a8400e800ffd8799fd8799fd87a9f581cca732cafaeaee5afcd23ee56b96d02f083a0567b3f0864986eb530b6ffd8799fd8799fd8799f581c140555c5a8e3062ea8a64f956e1af8b26db249ab6161d7b35a37a4b2ffffffffbf40bf401a00a404d4ff581cbd23e2977937bb6054f625e5b566e28e294dcd8f7e8d0d33979ed90cbf58203ace43d638bb7d86e2a27bf3535424e0184906e8514f43acbfe3eed7ab72750b01ffffd87b9f5f5840d8799f9fd8799f4e4345522f534e454b2d4144412f331b000000496cebb800d8799f1a000f424001ffffd8799f4d4345522f4144412d5553442f331b0000004958406cebb800d8799f186401ffffd8799f4d4345522f4d494e2d4144412f331b000000496cebb800d8799f0101ffffd8799f4e4345522f5348454e2d4144412f331b5840000000496cebb800d8799f0101ffffd8799f4e4345522f434f50492d4144412f331b000000496cebb800d8799f0101ffffd8799f4e4345522f494e44592d41445840412f331b000000496cebb800d8799f0101ffffd8799f4f4345522f4144412d66444a45442f331b000000496cebb800d8799f0101ffffd8799f4f4345522f41445840412d66555344432f331b000000496cebb800d8799f186401ffffd8799f4f4345522f4144412d66555344542f331b000000496cebb800d8799f186401ffffd87958409f4f4345522f4144412d665553444d2f331b000000496cebb800d8799f0101ffffd87a9f9f581cb9a05feafb9a147460f8c9e6f63de66d5f3d151ddcd93d01325840e90fb640ff9f581c0ec3d007cbc8140350f93b9f6e4529dbefd0d93d76ac428b72642d8c40ffffd87a9f9f581cda54a7c03d425528da20e0abae0dec9a7f96c05840c963ffa0c0b2e38ac440ff9f581c32ddd08c27d139c9af4d2d9d33c51e40c0eecab0a68d0d4c8a85768040ffffd87a9f9f581c9975292b341ff70ac18fad38705840de8791cb4d0ece11c04a74a9dc369940ff9f581cfb9f3e3fa95f506d46c90e693f3e0958bacef63fda9ac6925fffbed340ffffd87a9f9f581ca217f9484e3b78584054ff68242bd37600da6b734c1b467a6d4e902aac0740ff9f581c69dd878e10723df36980c5d05c58a2c13aed620a1a9de861f7b9403d40ffffd87a9f9f581ce858402288a29b1ffde3903e6424c14e5e1715a7984ace64090d3cd8a94d40ff9f581c4b9d1192b0715fab28972ed8ac96e8aab91e280216fbe8d4a52b3de540ffffd858407a9f9f581ca5ca01ca233315db3f6184f07c7dd21e24f1051680d2cced37d1977940ff9f581c68b0bf9c896daf159d05ca396efd442f39f3390863b6787927a15840c85240ffffd87a9f9f581cd04aff9d63ef29c2c3a9603b761eb103341140c3813beee9d6148faa40ff9f581cf3e567989bc40f4ad45c31956250e2846017466d58404529296952bb07e440ffffd87a9f9f581c11c41946e27c10d82161f999d9232da7ac02b388b77bf37f5b18df2040ff9f581c0c5bd179e926d195454a6da44df0584063fd20432ead308c4e74fc7eaf8340ffffd87a9f9f581c51bed4db1e9ec8ca4668fc3d217c2efb0029f727c2b80e1e1833796b40ff9f581cd12c7aee9c7c4b7f5840af32aae0b58e7485bde80a0b2b7b64eb573c832f40ffffd87a9f9f581c0ec6f9fa57e2b7fcf8d1aca5b188f72025796840d6d5db807bfac27340ff9f581ceb685840d0706d5bcfdedb920ba266cdda67bee124dfe99bd64adbcd650b40ffffd87a9f9f581ce2d66e364d30331808b949295dc664a898957ac7a6e558693454dff2405840ff9f581caab550c3ca67f86358653ef80f3043184a2c2a28f1344e26b8ab695a40ffffd87a9f9f581cf178d70eb9b63b8782337b6f3d3f4ab6472ec77a9d03de584091872b718040ff9f581cf3bbeb21b1517f529f1a4704d4fa25fa1d487b340566dee85d9f714140ffffd87a9f9f581ce9b0f8c72cc62e7e78c716f9cd359ca7ff584065246b5dc4b1d8e438b70640ff9f581cddc54c7a11d61c791574ec0ad02f01e52b4d50fd3c0c6d2a49532bbd40ffffd87a9f9f581c8503044498bcb5f801fd985840f41487f63275ee64085fc43dcc51b6913440ff9f581cf9b86f43f64724e5bb78af78594a85a318a0bbd2467ce6e0416e7e0240ffffd87b9f9f4040ffffd87b9f58409f581c9750b8f991a7f4f41dd5e03ea4a723ca2c4c71bd15363f8dfe04bcf14566444a4544ffffd87b9f9f581c834a15101873b4e1ddfaa830df46792913995d58408738dcde34eda2790545665553444dffffd87d9f9f581c9a5a89f494cf856f70c9ed42dc74e0c5b5fa139d6474ce1f991811c2526955534432303232313131385840313935393036ffd8799f011a000f4240ffffd87d9f9f581c27c7622613990af24385ba185ea402a08a114e07e5858bf07bd5a18e526942544332303232313131584038313932353130ffd8799f011a05f5e100ffffd87d9f9f581ca808b9f3438747d1f4adefdd2e951768b24b19c972931d8ec5fbe0dd526945544832303232313258403139313931333032ffd8799f011a05f5e100ffffd87e9f9f581ca420de4775e1c141f0bc5ff423051604a59741d651544682dad5e3584d446a65644f7261636c5840654e4654ffffd87c9f9f581c9d182e2f73d0a014bf45107301829167942f0c54cde20c516a8849d0581c7f0d1f5f1240dde7c4a36a8632ba37aa3668318022b358405f080295d845ffffd87c9f9f581c9d182e2f73d0a014bf45107301829167942f0c54cde20c516a8849d0581cdbad78f9ad842fd2a2dd88b61d53ffcbc08a2a2d5840d590c00b15426964ffffd87c9f9f581c9d182e2f73d0a014bf45107301829167942f0c54cde20c516a8849d0581ca217829b969c60a20d651c28f97ed24845095840470ae65b07fe394359a1ffffd87f9f9f581c0d104f933f0be3ec439eaf99a340a7c85e1e04101d1c16e1e846a625581ce66795acca6521e13cd099e41bd52d1e584013614e0c68b004c084a44d22ffffd905009f58205d79967b8337970a967813643436623aab142f7629cc00f6bcda175f4924ff8dd87a80ffd905009f58205d795840967b8337970a967813643436623aab142f7629cc00f6bcda175f4924ff8dd87980ffd905009f58206765bbd069a2b97c65867581fc3fa80ae748b86b806d97c2584044039efa9c440607d87a80ffd905009f58206765bbd069a2b97c65867581fc3fa80ae748b86b806d97c244039efa9c440607d87980ffd905009f5820bb5fdf94584085d67503c3f2873b229858daee3a8b346eb0e3d39a11370e2d680ffdd87a80ffd905009f5820bb5fdf9485d67503c3f2873b229858daee3a8b346eb0e3d39a114f370e2d680ffdd87980ffff1901f4ffffffd87a80ffffff9fd8799fd8799fd87a9f581c84cf3290f9070aa2c81f8b1edabc0eef0a98767bd353c22c6d47f0ffffd87a80ffbf40bf401a002dc6c0ff581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ebf44744441491b00000004ea3d4d25ff581ce85c54a6173bf0fd3ff21949a8e28cdac345892c5c9065b51f933180bf4001ffffd87b9f569f9f1a773594001b00000015781e5687000000ff0cffffd87a80ffd8799fd8799fd87a9f581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2ffd8799fd8799fd8799f581c4566506d723dadff77d5d2f15f60b2ddc806ee67449279900d83c8aeffffffffbf40bf401a00208dcaff581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e0bf401b00000015781e5687ff581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2bf581cfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe01ffffd87b9f5f5840d8799f9f9f581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e040ff9f581c919d4c2c9455016289341b1a14dedf697687af31751170d558406a31466e4474444149ffff1a773593ff1a773593ff1b00000196e0b0b800a19f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e4474581c4d494eff191f401907d01907081a03dcc50000d879801a01c9c380ffffffd87a80ffd8799fd8799fd8799f581cda0f113fc97ff0898c9b10d194c06c4eb588c5ae939c026f25cd7485ffd8799fd8799fd8799f581c4566506d723dadff77d5d2f15f60b2ddc806ee67449279900d83c8aeffffffffbf40bf401a0404ac46ff581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ebf4574414749581b0000002e90edd0004574434f50491a773594004574444a45441a7735940044744552471b000001d1a94a200044744941471a773594004574495553441a7735940044744d494e1a7735940045745348454e1a773594004574534e454b1907d04574555344431b0000002e90edd0004574555344541b0000002e90edd0004474574d541a77359400ff581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2bf581f50542dfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe1a773593ff581f59542dfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe1a773593ffffffd87980d87a80ffff1a00029810bf581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e0bf401b00000015781e5687ff581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2bf581f50542dfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe1a773593ff581f59542dfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe1a773593ff581cfd30c6b2aade696a20baa480550fa1a90121492ad31fb760453866fe01ffff80a0d8799fd8799fd87a9f1b00000196dd9f4d98ffd87a80ffd8799fd87a9f1b00000196dda4cbd8ffd87a80ffff80bfd8799f581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e0ff43d87980d8799f581cacf05d942cdc7150ea568a25a16dc2ec6d0ef579a1a76d41b4f9ecc2ff56d8799fd8799f01ffd87a80d87a80d87a8003d87a80ffd87a9fd8799f5820b3d45b0769adfb2d4d326e675cccd4e0874ba39be1011b236766219169ae687a02ffff43d87980d87b9fd87a9f581c171387cbbdd1110a118b03f846a8851e7e5360fdc7991eb7c2130da6ffff5f5840d8799f099f06ff9f9fd87980d87b8007ff9fd87980d87c8002ffffa19f581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e4474444149583bffa19f581c7d4913bb4e27f4708116769b1a77cd66e9110b2078c7f2c1d09bc0e040ffd8799f1b0000000b5e9655cc1b0000020c2ffed28bffa0ffffffa040a080d87a80d87a80ff",
    )
  expect fx_tx: FxTransaction = fx_tx
  expect _: Transaction = to_tx(fx_tx)
}
